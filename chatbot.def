bootstrap: docker
from: python:3.12-slim

%files
    docs/sherlock/    sherlock
    docs/farmshare/   farmshare
    docs/oak/         oak
    docs/elm/         elm
    .langchain.db
    requirements.txt

    
    
%environment
    # CUDA paths will be set by PyTorch
    
    
%post
    # Install system dependencies
    apt-get update && apt-get install -y --no-install-recommends \
        build-essential \
        libglib2.0-0 libxext6 libsm6 libxrender1 \
        git wget curl ca-certificates && \
        apt-get clean && rm -rf /var/lib/apt/lists/*

    pip install --upgrade pip
    
    # Install PyTorch with CUDA support (includes CUDA runtime)
    pip install torch torchvision torchaudio
    
    # Install requirements (should work now without mistral_inference/xformers)
    pip install -r requirements.txt
